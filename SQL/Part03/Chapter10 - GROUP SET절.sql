-- 실습준비
CREATE TABLE SALES
(
	BRAND VARCHAR NOT NULL,
	SEGMENT VARCHAR NOT NULL,
	QUANTITY INT NOT NULL,
	PRIMARY KEY (BRAND, SEGMENT)
)
;

INSERT INTO SALES 
	(BRAND, SEGMENT, QUANTITY)
VALUES
	('ABC', 'Premium', 100),
	('ABC', 'Basic', 200),
	('XYZ', 'Premium', 100),
	('XYZ', 'Basic', 300)
;

SELECT * FROM SALES;

--
SELECT
	BRAND,
	SEGMENT,
	SUM(QUANTITY)
FROM
	SALES
GROUP BY
	BRAND, SEGMENT
;

--
SELECT
	BRAND,
	SUM(QUANTITY)
FROM
	SALES
GROUP BY
	BRAND
;

-- 
SELECT
	SEGMENT,
	SUM(QUANTITY)
FROM
	SALES
GROUP BY
	SEGMENT
;

--
SELECT 
	SUM(QUANTITY)
FROM
	SALES
;

--
SELECT
	BRAND,
	SEGMENT,
	SUM(QUANTITY)
FROM
	SALES
GROUP BY
	BRAND,
	SEGMENT
UNION ALL 
SELECT 
	BRAND,
	NULL,
	SUM(QUANTITY)
FROM
	SALES
GROUP BY
	BRAND
UNION ALL
SELECT
	NULL,
	SEGMENT,
	SUM(QUANTITY)
FROM
	SALES
GROUP BY
	SEGMENT
UNION ALL 
SELECT 
	NULL,
	NULL,
	SUM(QUANTITY)
FROM
	SALES
;

--문법
SELECT
	C1,
	C2,
	집계함수(C3)
FROM
	TABLE_NAME
GROUP BY
GROUPING SETS
(
	(C1, C2),
	(C1),
	(C2),
	()
)
;

--
SELECT
	BRAND,
	SEGMENT,
	SUM(QUANTITY)
FROM
	SALES
GROUP BY
GROUPING SETS
(
	(BRAND, SEGMENT),
	(BRAND),
	(SEGMENT),
	()
)
;

--
SELECT
	GROUPING(BRAND),
	GROUPING(SEGMENT),
	BRAND,
	SEGMENT,
	SUM(QUANTITY)
FROM
	SALES
GROUP BY
GROUPING SETS
(
	(BRAND, SEGMENT),
	(BRAND),
	(SEGMENT),
	()
)
;