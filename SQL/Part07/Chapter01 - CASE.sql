SELECT
	CASE WHEN 조건식1 THEN 결과1
	CASE WHEN 조건식2 THEN 결과2
		 ELSE 결과3
	END
;

-- WHEN은 IF와 유사
-- WHEN은 ELSE IF와 유사
-- ELSE는 ELSE와 유사

SELECT
	SUM(
		CASE
		WHEN RENTAL_RATE = 0.99 THEN 1
		ELSE 0 END ) AS "C",
	SUM(
		CASE
		WHEN RENTAL_RATE = 2.99 THEN 1
		ELSE 0 END ) AS "0",
	SUM(
		CASE
		WHEN RENTAL_RATE = 4.99 THEN 1
		ELSE 0 END ) AS "A"
FROM FILM;


SELECT
	RENTAL_RATE, COUNT(*) CNT
FROM FILM
GROUP BY RENTAL_RATE;

--

SELECT
	SUM(
		CASE
		WHEN RENTAL_RATE = 0.99 THEN 1
		ELSE 0 END) AS "C",
	SUM(
		CASE
		WHEN RENTAL_RATE = 2.99 THEN 1
		ELSE 0 END) AS "B",
	SUM(
		CASE
		WHEN RENTAL_RATE = 4.99 THEN 1
		ELSE 0 END) AS "A"
FROM
	FILM
;

--
SELECT
	*
FROM
(
	SELECT	
		SUM(CASE WHEN RENTAL_RATE = 0.99 THEN CNT ELSE 0 END) AS C,
		SUM(CASE WHEN RENTAL_RATE = 2.99 THEN CNT ELSE 0 END) AS B,
		SUM(CASE WHEN RENTAL_RATE = 4.99 THEN CNT ELSE 0 END) AS A
	FROM
		(
			SELECT
				RENTAL_RATE, COUNT(*) CNT
			FROM FILM
			GROUP BY RENTAL_RATE
		) A
) A
;
