-- 아래 SQL문은 FILM 테이블을 2번이나 스캔하고 있다. FILM 테이블을 한번만 SCAN하여 동일한 결과 집을 구하는 SQL을 작성하라.
SELECT
	FILM_ID,
	TITLE,
	RENTAL_RATE
FROM
	FILM
WHERE RENTAL_RATE >
(
	SELECT
		AVG(RENTAL_RATE)
	FROM
		FILM
)
;

SELECT
	A.FILM_ID,
	A.TITLE,
	A.RENTAL_RATE
FROM
(
	SELECT
		A.FILM_ID,
		A.TITLE,
		A.RENTAL_RATE,
		AVG(A.RENTAL_RATE) OVER() AS AVG_RENTAL_RATE
	FROM
		FILM A
) A
WHERE
	A.RENTAL_RATE > A.AVG_RENTAL_RATE
;